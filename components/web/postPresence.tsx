"use client";
import usePresence from "@convex-dev/presence/react";
import FacePile from "@convex-dev/presence/facepile";
import { api } from "@/convex/_generated/api";
import { useState } from "react";
import { Id } from "@/convex/_generated/dataModel";

interface iAppProps {
    roomId: Id<'posts'>;
    userId: string;
}

export function PostPresence({ roomId, userId }: iAppProps) {
    const [name] = useState(() => "User " + Math.floor(Math.random() * 10000));
    const presenceState = usePresence(api.presence, roomId, userId);
    if (!presenceState || presenceState.length == 0) {
        return null
    }
    return (
        <div className="flex items-center gap-2">
            <p className="text-xs uppercase tracking-wide text-muted-foreground">Viewing now</p>
            <div className="text-black">
                <FacePile presenceState={presenceState ?? []} />
            </div>
        </div>
    );
}